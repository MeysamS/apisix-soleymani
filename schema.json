{"stream_plugins":{"syslog":{"priority":401,"metadata_schema":{"properties":{"log_format":{"type":"object"}},"type":"object"},"version":0.1,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["host","port"],"properties":{"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"max_retry_count":{"minimum":0,"type":"integer","default":0},"retry_delay":{"minimum":0,"type":"integer","default":1},"port":{"type":"integer"},"timeout":{"default":3000,"type":"integer","minimum":1},"batch_max_size":{"minimum":1,"type":"integer","default":1000},"inactive_timeout":{"minimum":1,"type":"integer","default":5},"host":{"type":"string"},"flush_limit":{"default":4096,"type":"integer","minimum":1},"drop_limit":{"default":1048576,"type":"integer"},"sock_type":{"enum":["tcp","udp"],"type":"string","default":"tcp"},"name":{"type":"string","default":"stream sys logger"},"tls":{"default":false,"type":"boolean"},"buffer_duration":{"minimum":1,"type":"integer","default":60},"pool_size":{"default":5,"type":"integer","minimum":5},"log_format":{"type":"object"}}}},"mqtt-proxy":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["protocol_name","protocol_level"],"properties":{"protocol_name":{"type":"string"},"protocol_level":{"type":"integer"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"}}},"version":0.1,"priority":1000},"limit-conn":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["conn","burst","default_conn_delay","key"],"properties":{"conn":{"exclusiveMinimum":0,"type":"integer"},"key_type":{"enum":["var","var_combination"],"default":"var","type":"string"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"key":{"type":"string"},"burst":{"minimum":0,"type":"integer"},"default_conn_delay":{"exclusiveMinimum":0,"type":"number"},"only_use_default_delay":{"default":false,"type":"boolean"}}},"version":0.1,"priority":1003},"ip-restriction":{"schema":{"$comment":"this is a mark for our injected plugin schema","oneOf":[{"required":["whitelist"]},{"required":["blacklist"]}],"type":"object","properties":{"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"whitelist":{"items":{"anyOf":[{"format":"ipv4","title":"IPv4","type":"string"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$","title":"IPv4/CIDR","type":"string"},{"format":"ipv6","title":"IPv6","type":"string"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$","title":"IPv6/CIDR","type":"string"}]},"minItems":1,"type":"array"},"message":{"maxLength":1024,"default":"Your IP address is not allowed","type":"string","minLength":1},"blacklist":{"items":{"anyOf":[{"format":"ipv4","title":"IPv4","type":"string"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$","title":"IPv4/CIDR","type":"string"},{"format":"ipv6","title":"IPv6","type":"string"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$","title":"IPv6/CIDR","type":"string"}]},"minItems":1,"type":"array"}}},"version":0.1,"priority":3000}},"main":{"global_rule":{"type":"object","additionalProperties":false,"required":["id","plugins"],"properties":{"create_time":{"type":"integer"},"update_time":{"type":"integer"},"id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"plugins":{"type":"object"}}},"upstream_hash_vars_schema":{"pattern":"^((uri|server_name|server_addr|request_uri|remote_port|remote_addr|query_string|host|hostname|mqtt_client_id)|arg_[0-9a-zA-z_-]+)$","type":"string"},"proto":{"type":"object","additionalProperties":false,"required":["content"],"properties":{"create_time":{"type":"integer"},"id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"content":{"maxLength":1048576,"type":"string","minLength":1},"update_time":{"type":"integer"},"desc":{"maxLength":256,"type":"string"}}},"service":{"type":"object","additionalProperties":false,"properties":{"enable_websocket":{"description":"enable websocket for request","type":"boolean"},"id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"script":{"maxLength":102400,"type":"string","minLength":10},"update_time":{"type":"integer"},"create_time":{"type":"integer"},"hosts":{"uniqueItems":true,"items":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"minItems":1,"type":"array"},"name":{"maxLength":100,"minLength":1,"type":"string"},"plugins":{"type":"object"},"upstream":{"properties":{"desc":{"maxLength":256,"type":"string"},"timeout":{"type":"object","required":["connect","send","read"],"properties":{"connect":{"exclusiveMinimum":0,"type":"number"},"send":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"}}},"update_time":{"type":"integer"},"create_time":{"type":"integer"},"retries":{"minimum":0,"type":"integer"},"retry_timeout":{"minimum":0,"type":"number"},"nodes":{"anyOf":[{"patternProperties":{".*":{"description":"weight of node","minimum":0,"type":"integer"}},"type":"object"},{"items":{"type":"object","required":["host","weight"],"properties":{"metadata":{"description":"metadata of node","type":"object"},"port":{"description":"port of node","minimum":1,"type":"integer"},"priority":{"description":"priority of node","default":0,"type":"integer"},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"weight":{"description":"weight of node","minimum":0,"type":"integer"}}},"type":"array"}]},"labels":{"description":"key/value pairs to specify attributes","patternProperties":{".*":{"maxLength":256,"description":"value of label","pattern":"^\\S+$","minLength":1,"type":"string"}},"type":"object"},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"hash_on":{"enum":["vars","header","cookie","consumer","vars_combinations"],"type":"string","default":"vars"},"id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"keepalive_pool":{"properties":{"size":{"minimum":1,"type":"integer","default":320},"idle_timeout":{"minimum":0,"type":"number","default":60},"requests":{"minimum":1,"type":"integer","default":1000}},"type":"object"},"scheme":{"enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"],"description":"The scheme of the upstream. For L7 proxy, it can be one of grpc/grpcs/http/https. For L4 proxy, it can be one of tcp/tls/udp. For specific protocols, it can be kafka.","default":"http"},"name":{"maxLength":100,"minLength":1,"type":"string"},"service_name":{"maxLength":256,"minLength":1,"type":"string"},"pass_host":{"description":"mod of host passing","default":"pass","enum":["pass","node","rewrite"],"type":"string"},"discovery_type":{"description":"discovery type","type":"string"},"upstream_host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"discovery_args":{"properties":{"group_name":{"description":"group name","type":"string"},"namespace_id":{"description":"namespace id","type":"string"}},"type":"object"},"type":{"description":"algorithms of load balancing","default":"roundrobin","type":"string"},"checks":{"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"additionalProperties":false,"type":"object","properties":{"active":{"properties":{"port":{"maximum":65535,"type":"integer","minimum":1},"timeout":{"default":1,"type":"number"},"concurrency":{"default":10,"type":"integer"},"http_path":{"default":"/","type":"string"},"https_verify_certificate":{"default":true,"type":"boolean"},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"unhealthy":{"properties":{"http_failures":{"maximum":254,"default":5,"type":"integer","minimum":1},"tcp_failures":{"maximum":254,"default":2,"type":"integer","minimum":1},"timeouts":{"maximum":254,"default":3,"type":"integer","minimum":1},"http_statuses":{"items":{"maximum":599,"type":"integer","minimum":200},"minItems":1,"default":[429,404,500,501,502,503,504,505],"type":"array","uniqueItems":true},"interval":{"default":1,"type":"integer","minimum":1}},"type":"object"},"req_headers":{"items":{"uniqueItems":true,"type":"string"},"type":"array","minItems":1},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"healthy":{"properties":{"successes":{"maximum":254,"default":2,"type":"integer","minimum":1},"http_statuses":{"items":{"maximum":599,"type":"integer","minimum":200},"minItems":1,"default":[200,302],"type":"array","uniqueItems":true},"interval":{"default":1,"type":"integer","minimum":1}},"type":"object"}},"type":"object"},"passive":{"properties":{"unhealthy":{"properties":{"timeouts":{"maximum":254,"default":7,"type":"integer","minimum":0},"http_failures":{"maximum":254,"default":5,"type":"integer","minimum":0},"http_statuses":{"items":{"maximum":599,"type":"integer","minimum":200},"minItems":1,"default":[429,500,503],"type":"array","uniqueItems":true},"tcp_failures":{"maximum":254,"default":2,"type":"integer","minimum":0}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"healthy":{"properties":{"http_statuses":{"items":{"maximum":599,"type":"integer","minimum":200},"minItems":1,"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"type":"array","uniqueItems":true},"successes":{"maximum":254,"default":5,"type":"integer","minimum":0}},"type":"object"}},"type":"object"}}},"tls":{"dependencies":{"client_cert_id":{"not":{"required":["client_cert","client_key"]}},"client_cert":{"required":["client_key"]},"client_key":{"required":["client_cert"]}},"type":"object","properties":{"verify":{"description":"Turn on server certificate verification, currently only kafka upstream is supported","default":false,"type":"boolean"},"client_cert_id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"client_cert":{"maxLength":65536,"type":"string","minLength":128},"client_key":{"maxLength":65536,"type":"string","minLength":128}}}},"additionalProperties":false,"oneOf":[{"required":["nodes"]},{"required":["service_name","discovery_type"]}],"type":"object"},"upstream_id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"desc":{"maxLength":256,"type":"string"},"labels":{"description":"key/value pairs to specify attributes","patternProperties":{".*":{"maxLength":256,"description":"value of label","pattern":"^\\S+$","minLength":1,"type":"string"}},"type":"object"}}},"upstream_hash_header_schema":{"pattern":"^[a-zA-Z0-9-_]+$","type":"string"},"ssl":{"else":{"required":["key","cert"]},"then":{"oneOf":[{"required":["sni","key","cert"]},{"required":["snis","key","cert"]}]},"properties":{"cert":{"oneOf":[{"maxLength":65536,"type":"string","minLength":128},{"pattern":"^\\$(secret|env)://","type":"string"}]},"id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"status":{"description":"ssl status, 1 to enable, 0 to disable","default":1,"enum":[1,0],"type":"integer"},"sni":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"update_time":{"type":"integer"},"keys":{"items":{"maxLength":65536,"type":"string","minLength":128},"type":"array"},"create_time":{"type":"integer"},"client":{"type":"object","required":["ca"],"properties":{"depth":{"default":1,"type":"integer","minimum":0},"ca":{"maxLength":65536,"type":"string","minLength":128},"skip_mtls_uri_regex":{"uniqueItems":true,"items":{"description":"uri regular expression to skip mtls","type":"string"},"type":"array","minItems":1}}},"ssl_protocols":{"maxItems":3,"description":"set ssl protocols","items":{"enum":["TLSv1.1","TLSv1.2","TLSv1.3"]},"type":"array","uniqueItems":true},"labels":{"description":"key/value pairs to specify attributes","patternProperties":{".*":{"maxLength":256,"description":"value of label","pattern":"^\\S+$","minLength":1,"type":"string"}},"type":"object"},"snis":{"items":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"minItems":1,"type":"array"},"certs":{"items":{"maxLength":65536,"type":"string","minLength":128},"type":"array"},"key":{"oneOf":[{"maxLength":65536,"type":"string","minLength":128},{"pattern":"^\\$(secret|env)://","type":"string"}]},"type":{"description":"ssl certificate type, server to server certificate, client to client certificate for upstream","enum":["server","client"],"default":"server","type":"string"}},"additionalProperties":false,"if":{"properties":{"type":{"enum":["server"]}}},"type":"object"},"stream_route":{"additionalProperties":false,"type":"object","properties":{"service_id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"desc":{"maxLength":256,"type":"string"},"protocol":{"type":"object","required":["name"],"properties":{"superior_id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"conf":{"description":"protocol-specific configuration","type":"object"},"name":{"type":"string"},"logger":{"items":{"dependencies":{"name":["conf"]},"additionalProperties":false,"properties":{"filter":{"description":"logger filter rules","type":"array"},"conf":{"description":"logger plugin configuration","type":"object"},"name":{"type":"string"}}},"type":"array"}}},"sni":{"description":"server name indication","pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"update_time":{"type":"integer"},"remote_addr":{"description":"client IP","anyOf":[{"format":"ipv4","title":"IPv4","type":"string"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$","title":"IPv4/CIDR","type":"string"},{"format":"ipv6","title":"IPv6","type":"string"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$","title":"IPv6/CIDR","type":"string"}],"type":"string"},"create_time":{"type":"integer"},"upstream_id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"server_addr":{"description":"server IP","anyOf":[{"format":"ipv4","title":"IPv4","type":"string"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$","title":"IPv4/CIDR","type":"string"},{"format":"ipv6","title":"IPv6","type":"string"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$","title":"IPv6/CIDR","type":"string"}],"type":"string"},"plugins":{"type":"object"},"upstream":{"properties":{"desc":{"maxLength":256,"type":"string"},"timeout":{"type":"object","required":["connect","send","read"],"properties":{"connect":{"exclusiveMinimum":0,"type":"number"},"send":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"}}},"update_time":{"type":"integer"},"create_time":{"type":"integer"},"retries":{"minimum":0,"type":"integer"},"retry_timeout":{"minimum":0,"type":"number"},"nodes":{"anyOf":[{"patternProperties":{".*":{"description":"weight of node","minimum":0,"type":"integer"}},"type":"object"},{"items":{"type":"object","required":["host","weight"],"properties":{"metadata":{"description":"metadata of node","type":"object"},"port":{"description":"port of node","minimum":1,"type":"integer"},"priority":{"description":"priority of node","default":0,"type":"integer"},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"weight":{"description":"weight of node","minimum":0,"type":"integer"}}},"type":"array"}]},"labels":{"description":"key/value pairs to specify attributes","patternProperties":{".*":{"maxLength":256,"description":"value of label","pattern":"^\\S+$","minLength":1,"type":"string"}},"type":"object"},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"hash_on":{"enum":["vars","header","cookie","consumer","vars_combinations"],"type":"string","default":"vars"},"id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"keepalive_pool":{"properties":{"size":{"minimum":1,"type":"integer","default":320},"idle_timeout":{"minimum":0,"type":"number","default":60},"requests":{"minimum":1,"type":"integer","default":1000}},"type":"object"},"scheme":{"enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"],"description":"The scheme of the upstream. For L7 proxy, it can be one of grpc/grpcs/http/https. For L4 proxy, it can be one of tcp/tls/udp. For specific protocols, it can be kafka.","default":"http"},"name":{"maxLength":100,"minLength":1,"type":"string"},"service_name":{"maxLength":256,"minLength":1,"type":"string"},"pass_host":{"description":"mod of host passing","default":"pass","enum":["pass","node","rewrite"],"type":"string"},"discovery_type":{"description":"discovery type","type":"string"},"upstream_host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"discovery_args":{"properties":{"group_name":{"description":"group name","type":"string"},"namespace_id":{"description":"namespace id","type":"string"}},"type":"object"},"type":{"description":"algorithms of load balancing","default":"roundrobin","type":"string"},"checks":{"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"additionalProperties":false,"type":"object","properties":{"active":{"properties":{"port":{"maximum":65535,"type":"integer","minimum":1},"timeout":{"default":1,"type":"number"},"concurrency":{"default":10,"type":"integer"},"http_path":{"default":"/","type":"string"},"https_verify_certificate":{"default":true,"type":"boolean"},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"unhealthy":{"properties":{"http_failures":{"maximum":254,"default":5,"type":"integer","minimum":1},"tcp_failures":{"maximum":254,"default":2,"type":"integer","minimum":1},"timeouts":{"maximum":254,"default":3,"type":"integer","minimum":1},"http_statuses":{"items":{"maximum":599,"type":"integer","minimum":200},"minItems":1,"default":[429,404,500,501,502,503,504,505],"type":"array","uniqueItems":true},"interval":{"default":1,"type":"integer","minimum":1}},"type":"object"},"req_headers":{"items":{"uniqueItems":true,"type":"string"},"type":"array","minItems":1},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"healthy":{"properties":{"successes":{"maximum":254,"default":2,"type":"integer","minimum":1},"http_statuses":{"items":{"maximum":599,"type":"integer","minimum":200},"minItems":1,"default":[200,302],"type":"array","uniqueItems":true},"interval":{"default":1,"type":"integer","minimum":1}},"type":"object"}},"type":"object"},"passive":{"properties":{"unhealthy":{"properties":{"timeouts":{"maximum":254,"default":7,"type":"integer","minimum":0},"http_failures":{"maximum":254,"default":5,"type":"integer","minimum":0},"http_statuses":{"items":{"maximum":599,"type":"integer","minimum":200},"minItems":1,"default":[429,500,503],"type":"array","uniqueItems":true},"tcp_failures":{"maximum":254,"default":2,"type":"integer","minimum":0}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"healthy":{"properties":{"http_statuses":{"items":{"maximum":599,"type":"integer","minimum":200},"minItems":1,"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"type":"array","uniqueItems":true},"successes":{"maximum":254,"default":5,"type":"integer","minimum":0}},"type":"object"}},"type":"object"}}},"tls":{"dependencies":{"client_cert_id":{"not":{"required":["client_cert","client_key"]}},"client_cert":{"required":["client_key"]},"client_key":{"required":["client_cert"]}},"type":"object","properties":{"verify":{"description":"Turn on server certificate verification, currently only kafka upstream is supported","default":false,"type":"boolean"},"client_cert_id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"client_cert":{"maxLength":65536,"type":"string","minLength":128},"client_key":{"maxLength":65536,"type":"string","minLength":128}}}},"additionalProperties":false,"oneOf":[{"required":["nodes"]},{"required":["service_name","discovery_type"]}],"type":"object"},"server_port":{"description":"server port","type":"integer"},"id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"labels":{"description":"key/value pairs to specify attributes","patternProperties":{".*":{"maxLength":256,"description":"value of label","pattern":"^\\S+$","minLength":1,"type":"string"}},"type":"object"}}},"route":{"properties":{"desc":{"maxLength":256,"type":"string"},"status":{"description":"route status, 1 to enable, 0 to disable","default":1,"enum":[1,0],"type":"integer"},"priority":{"default":0,"type":"integer"},"update_time":{"type":"integer"},"create_time":{"type":"integer"},"name":{"maxLength":100,"minLength":1,"type":"string"},"plugin_config_id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"upstream":{"properties":{"desc":{"maxLength":256,"type":"string"},"timeout":{"type":"object","required":["connect","send","read"],"properties":{"connect":{"exclusiveMinimum":0,"type":"number"},"send":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"}}},"update_time":{"type":"integer"},"create_time":{"type":"integer"},"retries":{"minimum":0,"type":"integer"},"retry_timeout":{"minimum":0,"type":"number"},"nodes":{"anyOf":[{"patternProperties":{".*":{"description":"weight of node","minimum":0,"type":"integer"}},"type":"object"},{"items":{"type":"object","required":["host","weight"],"properties":{"metadata":{"description":"metadata of node","type":"object"},"port":{"description":"port of node","minimum":1,"type":"integer"},"priority":{"description":"priority of node","default":0,"type":"integer"},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"weight":{"description":"weight of node","minimum":0,"type":"integer"}}},"type":"array"}]},"labels":{"description":"key/value pairs to specify attributes","patternProperties":{".*":{"maxLength":256,"description":"value of label","pattern":"^\\S+$","minLength":1,"type":"string"}},"type":"object"},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"hash_on":{"enum":["vars","header","cookie","consumer","vars_combinations"],"type":"string","default":"vars"},"id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"keepalive_pool":{"properties":{"size":{"minimum":1,"type":"integer","default":320},"idle_timeout":{"minimum":0,"type":"number","default":60},"requests":{"minimum":1,"type":"integer","default":1000}},"type":"object"},"scheme":{"enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"],"description":"The scheme of the upstream. For L7 proxy, it can be one of grpc/grpcs/http/https. For L4 proxy, it can be one of tcp/tls/udp. For specific protocols, it can be kafka.","default":"http"},"name":{"maxLength":100,"minLength":1,"type":"string"},"service_name":{"maxLength":256,"minLength":1,"type":"string"},"pass_host":{"description":"mod of host passing","default":"pass","enum":["pass","node","rewrite"],"type":"string"},"discovery_type":{"description":"discovery type","type":"string"},"upstream_host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"discovery_args":{"properties":{"group_name":{"description":"group name","type":"string"},"namespace_id":{"description":"namespace id","type":"string"}},"type":"object"},"type":{"description":"algorithms of load balancing","default":"roundrobin","type":"string"},"checks":{"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"additionalProperties":false,"type":"object","properties":{"active":{"properties":{"port":{"maximum":65535,"type":"integer","minimum":1},"timeout":{"default":1,"type":"number"},"concurrency":{"default":10,"type":"integer"},"http_path":{"default":"/","type":"string"},"https_verify_certificate":{"default":true,"type":"boolean"},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"unhealthy":{"properties":{"http_failures":{"maximum":254,"default":5,"type":"integer","minimum":1},"tcp_failures":{"maximum":254,"default":2,"type":"integer","minimum":1},"timeouts":{"maximum":254,"default":3,"type":"integer","minimum":1},"http_statuses":{"items":{"maximum":599,"type":"integer","minimum":200},"minItems":1,"default":[429,404,500,501,502,503,504,505],"type":"array","uniqueItems":true},"interval":{"default":1,"type":"integer","minimum":1}},"type":"object"},"req_headers":{"items":{"uniqueItems":true,"type":"string"},"type":"array","minItems":1},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"healthy":{"properties":{"successes":{"maximum":254,"default":2,"type":"integer","minimum":1},"http_statuses":{"items":{"maximum":599,"type":"integer","minimum":200},"minItems":1,"default":[200,302],"type":"array","uniqueItems":true},"interval":{"default":1,"type":"integer","minimum":1}},"type":"object"}},"type":"object"},"passive":{"properties":{"unhealthy":{"properties":{"timeouts":{"maximum":254,"default":7,"type":"integer","minimum":0},"http_failures":{"maximum":254,"default":5,"type":"integer","minimum":0},"http_statuses":{"items":{"maximum":599,"type":"integer","minimum":200},"minItems":1,"default":[429,500,503],"type":"array","uniqueItems":true},"tcp_failures":{"maximum":254,"default":2,"type":"integer","minimum":0}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"healthy":{"properties":{"http_statuses":{"items":{"maximum":599,"type":"integer","minimum":200},"minItems":1,"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"type":"array","uniqueItems":true},"successes":{"maximum":254,"default":5,"type":"integer","minimum":0}},"type":"object"}},"type":"object"}}},"tls":{"dependencies":{"client_cert_id":{"not":{"required":["client_cert","client_key"]}},"client_cert":{"required":["client_key"]},"client_key":{"required":["client_cert"]}},"type":"object","properties":{"verify":{"description":"Turn on server certificate verification, currently only kafka upstream is supported","default":false,"type":"boolean"},"client_cert_id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"client_cert":{"maxLength":65536,"type":"string","minLength":128},"client_key":{"maxLength":65536,"type":"string","minLength":128}}}},"additionalProperties":false,"oneOf":[{"required":["nodes"]},{"required":["service_name","discovery_type"]}],"type":"object"},"methods":{"items":{"description":"HTTP method","enum":["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE","PURGE"],"type":"string"},"uniqueItems":true,"type":"array"},"hosts":{"uniqueItems":true,"items":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"minItems":1,"type":"array"},"uris":{"uniqueItems":true,"items":{"description":"HTTP uri","type":"string"},"minItems":1,"type":"array"},"uri":{"maxLength":4096,"type":"string","minLength":1},"vars":{"type":"array"},"script":{"maxLength":102400,"type":"string","minLength":10},"id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"enable_websocket":{"description":"enable websocket for request","type":"boolean"},"upstream_id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"service_id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"labels":{"description":"key/value pairs to specify attributes","patternProperties":{".*":{"maxLength":256,"description":"value of label","pattern":"^\\S+$","minLength":1,"type":"string"}},"type":"object"},"script_id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"plugins":{"type":"object"},"filter_func":{"pattern":"^function","type":"string","minLength":10},"remote_addrs":{"uniqueItems":true,"items":{"description":"client IP","anyOf":[{"format":"ipv4","title":"IPv4","type":"string"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$","title":"IPv4/CIDR","type":"string"},{"format":"ipv6","title":"IPv6","type":"string"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$","title":"IPv6/CIDR","type":"string"}],"type":"string"},"minItems":1,"type":"array"},"timeout":{"type":"object","required":["connect","send","read"],"properties":{"connect":{"exclusiveMinimum":0,"type":"number"},"send":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"}}},"remote_addr":{"description":"client IP","anyOf":[{"format":"ipv4","title":"IPv4","type":"string"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$","title":"IPv4/CIDR","type":"string"},{"format":"ipv6","title":"IPv6","type":"string"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$","title":"IPv6/CIDR","type":"string"}],"type":"string"}},"anyOf":[{"required":["plugins","uri"]},{"required":["upstream","uri"]},{"required":["upstream_id","uri"]},{"required":["service_id","uri"]},{"required":["plugins","uris"]},{"required":["upstream","uris"]},{"required":["upstream_id","uris"]},{"required":["service_id","uris"]},{"required":["script","uri"]},{"required":["script","uris"]}],"not":{"anyOf":[{"required":["script","plugins"]},{"required":["script","plugin_config_id"]}]},"additionalProperties":false,"allOf":[{"oneOf":[{"required":["uri"]},{"required":["uris"]}]},{"oneOf":[{"not":{"anyOf":[{"required":["host"]},{"required":["hosts"]}]}},{"required":["host"]},{"required":["hosts"]}]},{"oneOf":[{"not":{"anyOf":[{"required":["remote_addr"]},{"required":["remote_addrs"]}]}},{"required":["remote_addr"]},{"required":["remote_addrs"]}]}],"type":"object"},"plugins":{"items":{"type":"object","required":["name"],"properties":{"additionalProperties":false,"name":{"minLength":1,"type":"string"},"stream":{"type":"boolean"}}},"type":"array"},"upstream":{"properties":{"desc":{"maxLength":256,"type":"string"},"timeout":{"type":"object","required":["connect","send","read"],"properties":{"connect":{"exclusiveMinimum":0,"type":"number"},"send":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"}}},"update_time":{"type":"integer"},"create_time":{"type":"integer"},"retries":{"minimum":0,"type":"integer"},"retry_timeout":{"minimum":0,"type":"number"},"nodes":{"anyOf":[{"patternProperties":{".*":{"description":"weight of node","minimum":0,"type":"integer"}},"type":"object"},{"items":{"type":"object","required":["host","weight"],"properties":{"metadata":{"description":"metadata of node","type":"object"},"port":{"description":"port of node","minimum":1,"type":"integer"},"priority":{"description":"priority of node","default":0,"type":"integer"},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"weight":{"description":"weight of node","minimum":0,"type":"integer"}}},"type":"array"}]},"labels":{"description":"key/value pairs to specify attributes","patternProperties":{".*":{"maxLength":256,"description":"value of label","pattern":"^\\S+$","minLength":1,"type":"string"}},"type":"object"},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"hash_on":{"enum":["vars","header","cookie","consumer","vars_combinations"],"type":"string","default":"vars"},"id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"keepalive_pool":{"properties":{"size":{"minimum":1,"type":"integer","default":320},"idle_timeout":{"minimum":0,"type":"number","default":60},"requests":{"minimum":1,"type":"integer","default":1000}},"type":"object"},"scheme":{"enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"],"description":"The scheme of the upstream. For L7 proxy, it can be one of grpc/grpcs/http/https. For L4 proxy, it can be one of tcp/tls/udp. For specific protocols, it can be kafka.","default":"http"},"name":{"maxLength":100,"minLength":1,"type":"string"},"service_name":{"maxLength":256,"minLength":1,"type":"string"},"pass_host":{"description":"mod of host passing","default":"pass","enum":["pass","node","rewrite"],"type":"string"},"discovery_type":{"description":"discovery type","type":"string"},"upstream_host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"discovery_args":{"properties":{"group_name":{"description":"group name","type":"string"},"namespace_id":{"description":"namespace id","type":"string"}},"type":"object"},"type":{"description":"algorithms of load balancing","default":"roundrobin","type":"string"},"checks":{"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"additionalProperties":false,"type":"object","properties":{"active":{"properties":{"port":{"maximum":65535,"type":"integer","minimum":1},"timeout":{"default":1,"type":"number"},"concurrency":{"default":10,"type":"integer"},"http_path":{"default":"/","type":"string"},"https_verify_certificate":{"default":true,"type":"boolean"},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"unhealthy":{"properties":{"http_failures":{"maximum":254,"default":5,"type":"integer","minimum":1},"tcp_failures":{"maximum":254,"default":2,"type":"integer","minimum":1},"timeouts":{"maximum":254,"default":3,"type":"integer","minimum":1},"http_statuses":{"items":{"maximum":599,"type":"integer","minimum":200},"minItems":1,"default":[429,404,500,501,502,503,504,505],"type":"array","uniqueItems":true},"interval":{"default":1,"type":"integer","minimum":1}},"type":"object"},"req_headers":{"items":{"uniqueItems":true,"type":"string"},"type":"array","minItems":1},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"healthy":{"properties":{"successes":{"maximum":254,"default":2,"type":"integer","minimum":1},"http_statuses":{"items":{"maximum":599,"type":"integer","minimum":200},"minItems":1,"default":[200,302],"type":"array","uniqueItems":true},"interval":{"default":1,"type":"integer","minimum":1}},"type":"object"}},"type":"object"},"passive":{"properties":{"unhealthy":{"properties":{"timeouts":{"maximum":254,"default":7,"type":"integer","minimum":0},"http_failures":{"maximum":254,"default":5,"type":"integer","minimum":0},"http_statuses":{"items":{"maximum":599,"type":"integer","minimum":200},"minItems":1,"default":[429,500,503],"type":"array","uniqueItems":true},"tcp_failures":{"maximum":254,"default":2,"type":"integer","minimum":0}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"healthy":{"properties":{"http_statuses":{"items":{"maximum":599,"type":"integer","minimum":200},"minItems":1,"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"type":"array","uniqueItems":true},"successes":{"maximum":254,"default":5,"type":"integer","minimum":0}},"type":"object"}},"type":"object"}}},"tls":{"dependencies":{"client_cert_id":{"not":{"required":["client_cert","client_key"]}},"client_cert":{"required":["client_key"]},"client_key":{"required":["client_cert"]}},"type":"object","properties":{"verify":{"description":"Turn on server certificate verification, currently only kafka upstream is supported","default":false,"type":"boolean"},"client_cert_id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"client_cert":{"maxLength":65536,"type":"string","minLength":128},"client_key":{"maxLength":65536,"type":"string","minLength":128}}}},"additionalProperties":false,"oneOf":[{"required":["nodes"]},{"required":["service_name","discovery_type"]}],"type":"object"},"consumer":{"type":"object","additionalProperties":false,"required":["username"],"properties":{"group_id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"desc":{"maxLength":256,"type":"string"},"plugins":{"type":"object"},"username":{"maxLength":100,"pattern":"^[a-zA-Z0-9_]+$","type":"string","minLength":1},"create_time":{"type":"integer"},"update_time":{"type":"integer"},"labels":{"description":"key/value pairs to specify attributes","patternProperties":{".*":{"maxLength":256,"description":"value of label","pattern":"^\\S+$","minLength":1,"type":"string"}},"type":"object"}}},"plugin_config":{"type":"object","additionalProperties":false,"required":["id","plugins"],"properties":{"create_time":{"type":"integer"},"id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"plugins":{"type":"object"},"name":{"type":"string"},"desc":{"maxLength":256,"type":"string"},"update_time":{"type":"integer"},"labels":{"description":"key/value pairs to specify attributes","patternProperties":{".*":{"maxLength":256,"description":"value of label","pattern":"^\\S+$","minLength":1,"type":"string"}},"type":"object"}}},"consumer_group":{"type":"object","additionalProperties":false,"required":["id","plugins"],"properties":{"create_time":{"type":"integer"},"desc":{"maxLength":256,"type":"string"},"plugins":{"type":"object"},"id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"update_time":{"type":"integer"},"labels":{"description":"key/value pairs to specify attributes","patternProperties":{".*":{"maxLength":256,"description":"value of label","pattern":"^\\S+$","minLength":1,"type":"string"}},"type":"object"}}}},"plugins":{"grpc-transcode":{"priority":506,"version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"proto_id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"method":{"description":"the method name in the grpc service.","type":"string"},"deadline":{"description":"deadline for grpc, millisecond","default":0,"type":"number"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"pb_option":{"default":["enum_as_name","int64_as_number","auto_default_values","disable_hooks"],"items":{"anyOf":[{"description":"enum as result","enum":["int64_as_number","int64_as_string","int64_as_hexstring"],"type":"string"},{"description":"int64 as result","enum":["enum_as_name","enum_as_value"],"type":"string"},{"description":"default values option","enum":["auto_default_values","no_default_values","use_default_values","use_default_metatable"],"type":"string"},{"description":"hooks option","enum":["enable_hooks","disable_hooks"],"type":"string"}],"type":"string"},"minItems":1,"type":"array"},"show_status_in_body":{"description":"show decoded grpc-status-details-bin in response body","default":false,"type":"boolean"},"service":{"description":"the grpc service name","type":"string"},"status_detail_type":{"description":"the message type of the grpc-status-details-bin's details part, if not given, the details part will not be decoded","type":"string"}},"additionalProperties":true,"required":["proto_id","service","method"],"type":"object"}},"serverless-post-function":{"priority":-2000,"version":0.1,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["functions"],"properties":{"phase":{"enum":["rewrite","access","header_filter","body_filter","log","before_proxy"],"type":"string","default":"access"},"functions":{"items":{"type":"string"},"minItems":1,"type":"array"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"}}}},"proxy-cache":{"priority":1085,"version":0.2,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"cache_key":{"default":["$host","$request_uri"],"items":{"description":"a key for caching","pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)","type":"string"},"type":"array","minItems":1},"cache_ttl":{"default":300,"type":"integer","minimum":1},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"cache_http_status":{"items":{"description":"http response status","maximum":599,"minimum":200,"type":"integer"},"minItems":1,"default":[200,301,404],"type":"array","uniqueItems":true},"cache_method":{"items":{"description":"supported http method","enum":["GET","POST","HEAD"],"type":"string"},"minItems":1,"default":["GET","HEAD"],"type":"array","uniqueItems":true},"hide_cache_headers":{"default":false,"type":"boolean"},"cache_control":{"default":false,"type":"boolean"},"cache_bypass":{"items":{"pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)","type":"string"},"type":"array","minItems":1},"no_cache":{"items":{"pattern":"(^[^\\$].+$|^\\$[0-9a-zA-Z_]+$)","type":"string"},"type":"array","minItems":1},"cache_zone":{"maxLength":100,"default":"disk_cache_one","type":"string","minLength":1},"cache_strategy":{"enum":["disk","memory"],"default":"disk","type":"string"}}}},"server-info":{"priority":990,"scope":"global","version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"}}}},"kafka-logger":{"priority":403,"metadata_schema":{"properties":{"log_format":{"type":"object"}},"type":"object"},"version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","oneOf":[{"required":["broker_list","kafka_topic"]},{"required":["brokers","kafka_topic"]}],"type":"object","properties":{"meta_format":{"enum":["default","origin"],"type":"string","default":"default"},"max_retry_count":{"minimum":0,"type":"integer","default":0},"include_req_body":{"default":false,"type":"boolean"},"buffer_duration":{"minimum":1,"type":"integer","default":60},"timeout":{"default":3,"type":"integer","minimum":1},"kafka_topic":{"type":"string"},"producer_type":{"enum":["async","sync"],"type":"string","default":"async"},"required_acks":{"enum":[1,-1],"type":"integer","default":1},"cluster_name":{"default":1,"type":"integer","minimum":1},"producer_batch_num":{"default":200,"type":"integer","minimum":1},"producer_batch_size":{"default":1048576,"type":"integer","minimum":0},"producer_max_buffering":{"default":50000,"type":"integer","minimum":1},"producer_time_linger":{"default":1,"type":"integer","minimum":1},"meta_refresh_interval":{"default":30,"type":"integer","minimum":1},"log_format":{"type":"object"},"key":{"type":"string"},"inactive_timeout":{"minimum":1,"type":"integer","default":5},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"include_resp_body_expr":{"items":{"type":"array"},"type":"array","minItems":1},"include_resp_body":{"default":false,"type":"boolean"},"batch_max_size":{"minimum":1,"type":"integer","default":1000},"name":{"type":"string","default":"kafka logger"},"retry_delay":{"minimum":0,"type":"integer","default":1},"broker_list":{"type":"object","patternProperties":{".*":{"description":"the port of kafka broker","maximum":65535,"minimum":1,"type":"integer"}},"minProperties":1},"include_req_body_expr":{"items":{"type":"array"},"type":"array","minItems":1},"brokers":{"uniqueItems":true,"items":{"type":"object","required":["host","port"],"properties":{"sasl_config":{"description":"sasl config","properties":{"mechanism":{"enum":["PLAIN"],"type":"string","default":"PLAIN"},"password":{"description":"password","type":"string"},"user":{"description":"user","type":"string"}},"required":["user","password"],"type":"object"},"host":{"description":"the host of kafka broker","type":"string"},"port":{"maximum":65535,"description":"the port of kafka broker","type":"integer","minimum":1}}},"type":"array","minItems":1}}}},"cors":{"priority":4000,"metadata_schema":{"properties":{"allow_origins":{"additionalProperties":{"pattern":"^(\\*|\\*\\*|null|\\w+://[^,]+(,\\w+://[^,]+)*)$","type":"string"},"type":"object"}},"type":"object"},"version":0.1,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"allow_origins_by_regex":{"items":{"maxLength":4096,"type":"string","minLength":1},"minItems":1,"description":"you can use regex to allow specific origins when no credentials,for example use [.*\\.test.com$] to allow a.test.com and b.test.com","uniqueItems":true,"type":"array"},"allow_methods":{"description":"you can use '*' to allow all methods when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple method use ',' to split. default: *.","default":"*","type":"string"},"allow_origins_by_metadata":{"items":{"maxLength":4096,"type":"string","minLength":1},"minItems":1,"description":"set allowed origins by referencing origins in plugin metadata","uniqueItems":true,"type":"array"},"allow_headers":{"description":"you can use '*' to allow all header when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple header use ',' to split. default: *.","default":"*","type":"string"},"expose_headers":{"description":"you can use '*' to expose all header when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple header use ',' to split. default: *.","default":"*","type":"string"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"timing_allow_origins_by_regex":{"items":{"maxLength":4096,"type":"string","minLength":1},"minItems":1,"description":"you can use regex to allow specific origins which can view timing information,for example use [.*\\.test.com] to allow a.test.com and b.test.com","uniqueItems":true,"type":"array"},"timing_allow_origins":{"description":"you can use '*' to allow all origins which can view timing information when no credentials,'**' to allow forcefully (it will bring some security risks, be careful),multiple origin use ',' to split. default: nil","pattern":"^(\\*|\\*\\*|null|\\w+://[^,]+(,\\w+://[^,]+)*)$","type":"string"},"max_age":{"description":"maximum number of seconds the results can be cached.-1 means no cached, the max value is depend on browser,more details plz check MDN. default: 5.","default":5,"type":"integer"},"allow_credential":{"description":"allow client append credential. according to CORS specification,if you set this option to 'true', you can not use '*' for other options.","default":false,"type":"boolean"},"allow_origins":{"description":"you can use '*' to allow all origins when no credentials,'**' to allow forcefully(it will bring some security risks, be carefully),multiple origin use ',' to split. default: *.","pattern":"^(\\*|\\*\\*|null|\\w+://[^,]+(,\\w+://[^,]+)*)$","default":"*","type":"string"}}}},"openid-connect":{"schema":{"$comment":"this is a mark for our injected plugin schema","encrypt_fields":["client_secret"],"properties":{"set_access_token_header":{"description":"Whether the access token should be added as a header to the request for downstream","default":true,"type":"boolean"},"client_id":{"type":"string"},"proxy_opts":{"description":"HTTP proxy server be used to access identity server.","properties":{"http_proxy":{"description":"HTTP proxy like: http://proxy-server:80.","type":"string"},"https_proxy":{"description":"HTTPS proxy like: http://proxy-server:80.","type":"string"},"no_proxy":{"description":"Comma separated list of hosts that should not be proxied.","type":"string"},"https_proxy_authorization":{"description":"Basic [base64 username:password].","type":"string"},"http_proxy_authorization":{"description":"Basic [base64 username:password].","type":"string"}},"type":"object"},"access_token_expires_leeway":{"description":"Expiration leeway in seconds for access token renewal.","default":0,"type":"integer"},"force_reauthorize":{"description":"Whether to execute the authorization flow when a token has been cached.","default":false,"type":"boolean"},"use_nonce":{"description":"Whether to include nonce parameter in authorization request.","default":false,"type":"boolean"},"revoke_tokens_on_logout":{"description":"Notify authorization server a previous token is no longer needed.","default":false,"type":"boolean"},"jwk_expires_in":{"description":"Expiration time for JWK cache in seconds.","default":86400,"type":"integer"},"jwt_verification_cache_ignore":{"description":"Whether to ignore cached verification and re-verify.","default":false,"type":"boolean"},"cache_segment":{"description":"Name of a cache segment to differentiate caches.","type":"string"},"introspection_interval":{"description":"TTL of the cached and introspected access token in seconds.","default":0,"type":"integer"},"introspection_expiry_claim":{"description":"Name of the expiry claim that controls the cached access token TTL.","type":"string"},"required_scopes":{"description":"List of scopes that are required to be granted to the access token","items":{"type":"string"},"type":"array"},"discovery":{"type":"string"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"accept_unsupported_alg":{"description":"Ignore ID token signature to accept unsupported signature algorithm.","default":true,"type":"boolean"},"accept_none_alg":{"description":"Set to true if the OpenID provider does not sign its ID token.","default":false,"type":"boolean"},"iat_slack":{"description":"Tolerance of clock skew in seconds with the iat claim in an ID token.","default":120,"type":"integer"},"timeout":{"description":"timeout in seconds","default":3,"type":"integer","minimum":1},"scope":{"default":"openid","type":"string"},"set_id_token_header":{"description":"Whether the ID token should be added in the X-ID-Token header to the request for downstream.","default":true,"type":"boolean"},"client_secret":{"type":"string"},"public_key":{"type":"string"},"ssl_verify":{"default":false,"type":"boolean"},"set_refresh_token_header":{"description":"Whether the refresh token should be added in the X-Refresh-Token header to the request for downstream.","default":false,"type":"boolean"},"introspection_endpoint_auth_method":{"default":"client_secret_basic","type":"string"},"introspection_endpoint":{"type":"string"},"token_endpoint_auth_method":{"default":"client_secret_basic","type":"string"},"bearer_only":{"default":false,"type":"boolean"},"session":{"type":"object","additionalProperties":false,"required":["secret"],"properties":{"secret":{"description":"the key used for the encrypt and HMAC calculation","minLength":16,"type":"string"}}},"access_token_in_authorization_header":{"description":"Whether the access token should be added in the Authorization header as opposed to the X-Access-Token header.","default":false,"type":"boolean"},"authorization_params":{"description":"Extra authorization params to the authorize endpoint","type":"object"},"logout_path":{"default":"/logout","type":"string"},"client_rsa_private_key":{"description":"Client RSA private key used to sign JWT.","type":"string"},"redirect_uri":{"description":"auto append '.apisix/redirect' to ngx.var.uri if not configured","type":"string"},"client_rsa_private_key_id":{"description":"Client RSA private key ID used to compute a signed JWT.","type":"string"},"post_logout_redirect_uri":{"description":"the URI will be redirect when request logout_path","type":"string"},"client_jwt_assertion_expires_in":{"description":"Life duration of the signed JWT in seconds.","default":60,"type":"integer"},"unauth_action":{"enum":["auth","deny","pass"],"description":"The action performed when client is not authorized. Use auth to redirect user to identity provider, deny to respond with 401 Unauthorized, and pass to allow the request regardless.","type":"string","default":"auth"},"renew_access_token_on_expiry":{"description":"Whether to attempt silently renewing the access token.","default":true,"type":"boolean"},"realm":{"default":"apisix","type":"string"},"access_token_expires_in":{"description":"Lifetime of the access token in seconds if expires_in is not present.","type":"integer"},"set_userinfo_header":{"description":"Whether the user info token should be added in the X-Userinfo header to the request for downstream.","default":true,"type":"boolean"},"refresh_session_interval":{"description":"Time interval to refresh user ID token without re-authentication.","type":"integer"},"token_signing_alg_values_expected":{"type":"string"},"use_pkce":{"description":"when set to true the PKEC(Proof Key for Code Exchange) will be used.","default":false,"type":"boolean"}},"required":["client_id","client_secret","discovery"],"type":"object"},"version":0.2,"priority":2599},"zipkin":{"priority":12011,"version":0.1,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["endpoint","sample_ratio"],"properties":{"service_name":{"description":"service name for zipkin reporter","default":"APISIX","type":"string"},"server_addr":{"description":"default is $server_addr, you can specify your external ip address","pattern":"^[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}$","type":"string"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"endpoint":{"type":"string"},"span_version":{"enum":[1,2],"default":2},"sample_ratio":{"maximum":1,"type":"number","minimum":1e-05}}}},"authz-keycloak":{"schema":{"$comment":"this is a mark for our injected plugin schema","allOf":[{"anyOf":[{"required":["discovery"]},{"required":["token_endpoint"]}]},{"anyOf":[{"properties":{"lazy_load_paths":{"enum":[false]}}},{"anyOf":[{"required":["discovery"]},{"required":["resource_registration_endpoint"]}],"properties":{"lazy_load_paths":{"enum":[true]}}}]}],"encrypt_fields":["client_secret"],"properties":{"cache_ttl_seconds":{"default":86400,"type":"integer","minimum":1},"access_denied_redirect_uri":{"maxLength":2048,"type":"string","minLength":1},"refresh_token_expires_in":{"default":3600,"type":"integer","minimum":1},"client_id":{"maxLength":100,"type":"string","minLength":1},"timeout":{"default":3000,"type":"integer","minimum":1000},"access_token_expires_leeway":{"default":0,"type":"integer","minimum":0},"client_secret":{"maxLength":100,"type":"string","minLength":1},"grant_type":{"maxLength":100,"enum":["urn:ietf:params:oauth:grant-type:uma-ticket"],"default":"urn:ietf:params:oauth:grant-type:uma-ticket","type":"string","minLength":1},"token_endpoint":{"maxLength":4096,"type":"string","minLength":1},"keepalive":{"default":true,"type":"boolean"},"keepalive_timeout":{"default":60000,"type":"integer","minimum":1000},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"keepalive_pool":{"default":5,"type":"integer","minimum":1},"password_grant_token_generation_incoming_uri":{"maxLength":4096,"type":"string","minLength":1},"refresh_token_expires_leeway":{"default":0,"type":"integer","minimum":0},"resource_registration_endpoint":{"maxLength":4096,"type":"string","minLength":1},"discovery":{"maxLength":4096,"type":"string","minLength":1},"policy_enforcement_mode":{"enum":["ENFORCING","PERMISSIVE"],"default":"ENFORCING","type":"string"},"access_token_expires_in":{"default":300,"type":"integer","minimum":1},"ssl_verify":{"default":true,"type":"boolean"},"permissions":{"default":{},"items":{"maxLength":100,"type":"string","minLength":1},"uniqueItems":true,"type":"array"},"lazy_load_paths":{"default":false,"type":"boolean"},"http_method_as_scope":{"default":false,"type":"boolean"}},"required":["client_id"],"type":"object"},"version":0.1,"priority":2000},"uri-blocker":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["block_rules"],"properties":{"case_insensitive":{"default":false,"type":"boolean"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"block_rules":{"items":{"maxLength":4096,"type":"string","minLength":1},"uniqueItems":true,"type":"array"},"rejected_code":{"default":403,"type":"integer","minimum":200},"rejected_msg":{"minLength":1,"type":"string"}}},"version":0.1,"priority":2900},"request-validation":{"schema":{"anyOf":[{"required":["header_schema"]},{"required":["body_schema"]}],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"header_schema":{"type":"object"},"body_schema":{"type":"object"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"rejected_code":{"maximum":599,"default":400,"type":"integer","minimum":200},"rejected_msg":{"maxLength":256,"type":"string","minLength":1}}},"priority":2800,"version":0.1,"type":"validation"},"tcp-logger":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["host","port"],"properties":{"max_retry_count":{"minimum":0,"type":"integer","default":0},"include_req_body":{"default":false,"type":"boolean"},"port":{"minimum":0,"type":"integer"},"timeout":{"default":1000,"type":"integer","minimum":1},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"host":{"type":"string"},"inactive_timeout":{"minimum":1,"type":"integer","default":5},"batch_max_size":{"minimum":1,"type":"integer","default":1000},"name":{"type":"string","default":"tcp logger"},"buffer_duration":{"minimum":1,"type":"integer","default":60},"tls":{"default":false,"type":"boolean"},"retry_delay":{"minimum":0,"type":"integer","default":1},"tls_options":{"type":"string"},"log_format":{"type":"object"}}},"metadata_schema":{"properties":{"log_format":{"type":"object"}},"type":"object"},"version":0.1,"priority":405},"proxy-mirror":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["host"],"properties":{"sample_ratio":{"maximum":1,"default":1,"type":"number","minimum":1e-05},"path_concat_mode":{"enum":["replace","prefix"],"description":"the concatenation mode for custom path","type":"string","default":"replace"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"path":{"pattern":"^/[^?&]+$","type":"string"},"host":{"pattern":"^(http(s)?|grpc(s)?):\\/\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?$","type":"string"}}},"version":0.1,"priority":1010},"sls-logger":{"schema":{"$comment":"this is a mark for our injected plugin schema","encrypt_fields":["access_key_secret"],"properties":{"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"max_retry_count":{"minimum":0,"type":"integer","default":0},"include_req_body":{"default":false,"type":"boolean"},"port":{"type":"integer"},"project":{"type":"string"},"logstore":{"type":"string"},"access_key_id":{"type":"string"},"host":{"type":"string"},"inactive_timeout":{"minimum":1,"type":"integer","default":5},"batch_max_size":{"minimum":1,"type":"integer","default":1000},"name":{"type":"string","default":"sls-logger"},"buffer_duration":{"minimum":1,"type":"integer","default":60},"retry_delay":{"minimum":0,"type":"integer","default":1},"access_key_secret":{"type":"string"},"timeout":{"default":5000,"type":"integer","minimum":1},"log_format":{"type":"object"}},"required":["host","port","project","logstore","access_key_id","access_key_secret"],"type":"object"},"version":0.1,"priority":406},"request-id":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"header_name":{"default":"X-Request-Id","type":"string"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"include_in_response":{"default":true,"type":"boolean"},"algorithm":{"enum":["uuid","nanoid","range_id"],"default":"uuid","type":"string"},"range_id":{"default":{},"type":"object","properties":{"char_set":{"default":"abcdefghijklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZ0123456789","type":"string","minLength":6},"length":{"default":16,"type":"integer","minimum":6}}}}},"version":0.1,"priority":12015},"response-rewrite":{"schema":{"dependencies":{"body":{"not":{"required":["filters"]}},"filters":{"not":{"required":["body"]}}},"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"filters":{"description":"a group of filters that modify response bodyby replacing one specified string by another","items":{"description":"filter that modifies response body","properties":{"options":{"description":"regex options","default":"jo","type":"string"},"scope":{"description":"regex substitution range","default":"once","enum":["once","global"],"type":"string"},"replace":{"description":"regex substitution content","type":"string"},"regex":{"description":"match pattern on response body","minLength":1,"type":"string"}},"required":["regex","replace"],"type":"object"},"minItems":1,"type":"array"},"body_base64":{"description":"whether new body for response need base64 decode before return","default":false,"type":"boolean"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"status_code":{"description":"new status code for response","maximum":598,"minimum":200,"type":"integer"},"vars":{"type":"array"},"headers":{"description":"new headers for response","anyOf":[{"type":"object","patternProperties":{"^[^:]+$":{"oneOf":[{"type":"string"},{"type":"number"}]}},"minProperties":1},{"properties":{"remove":{"items":{"pattern":"^[^:]+$","type":"string"},"type":"array","minItems":1},"add":{"items":{"pattern":"^[^:]+:[^:]*[^/]$","type":"string"},"type":"array","minItems":1},"set":{"type":"object","patternProperties":{"^[^:]+$":{"oneOf":[{"type":"string"},{"type":"number"}]}},"minProperties":1}}}]},"body":{"description":"new body for response","type":"string"}}},"version":0.1,"priority":899},"limit-count":{"schema":{"$comment":"this is a mark for our injected plugin schema","else":{"then":{"required":["redis_cluster_nodes","redis_cluster_name"],"properties":{"redis_password":{"minLength":0,"type":"string"},"redis_cluster_ssl_verify":{"default":false,"type":"boolean"},"redis_timeout":{"default":1000,"type":"integer","minimum":1},"redis_cluster_ssl":{"default":false,"type":"boolean"},"redis_cluster_nodes":{"items":{"maxLength":100,"type":"string","minLength":2},"type":"array","minItems":1},"redis_cluster_name":{"type":"string"}}},"if":{"properties":{"policy":{"enum":["redis-cluster"]}}}},"if":{"properties":{"policy":{"enum":["redis"]}}},"then":{"required":["redis_host"],"properties":{"redis_password":{"minLength":0,"type":"string"},"redis_database":{"default":0,"type":"integer","minimum":0},"redis_timeout":{"default":1000,"type":"integer","minimum":1},"redis_ssl":{"default":false,"type":"boolean"},"redis_ssl_verify":{"default":false,"type":"boolean"},"redis_host":{"minLength":2,"type":"string"},"redis_port":{"default":6379,"type":"integer","minimum":1},"redis_username":{"minLength":1,"type":"string"}}},"properties":{"key":{"default":"remote_addr","type":"string"},"show_limit_quota_header":{"default":true,"type":"boolean"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"rejected_code":{"maximum":599,"default":503,"type":"integer","minimum":200},"rejected_msg":{"minLength":1,"type":"string"},"count":{"exclusiveMinimum":0,"type":"integer"},"allow_degradation":{"default":false,"type":"boolean"},"time_window":{"exclusiveMinimum":0,"type":"integer"},"key_type":{"enum":["var","var_combination","constant"],"default":"var","type":"string"},"group":{"type":"string"},"policy":{"enum":["local","redis","redis-cluster"],"default":"local","type":"string"}},"required":["count","time_window"],"type":"object"},"version":0.5,"priority":1002},"jwt-auth":{"consumer_schema":{"dependencies":{"algorithm":{"oneOf":[{"properties":{"algorithm":{"enum":["HS256","HS512"],"default":"HS256"}}},{"required":["public_key","private_key"],"properties":{"public_key":{"type":"string"},"private_key":{"type":"string"},"algorithm":{"enum":["RS256","ES256"]}}}]}},"encrypt_fields":["secret","private_key"],"properties":{"key":{"type":"string"},"lifetime_grace_period":{"default":0,"type":"integer","minimum":0},"base64_secret":{"default":false,"type":"boolean"},"secret":{"type":"string"},"algorithm":{"enum":["HS256","HS512","RS256","ES256"],"default":"HS256","type":"string"},"exp":{"default":86400,"type":"integer","minimum":1}},"required":["key"],"type":"object"},"priority":2510,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"query":{"default":"jwt","type":"string"},"cookie":{"default":"jwt","type":"string"},"hide_credentials":{"default":false,"type":"boolean"},"header":{"default":"authorization","type":"string"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"}}},"version":0.1,"type":"auth"},"ip-restriction":{"schema":{"$comment":"this is a mark for our injected plugin schema","oneOf":[{"required":["whitelist"]},{"required":["blacklist"]}],"type":"object","properties":{"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"whitelist":{"items":{"anyOf":[{"format":"ipv4","title":"IPv4","type":"string"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$","title":"IPv4/CIDR","type":"string"},{"format":"ipv6","title":"IPv6","type":"string"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$","title":"IPv6/CIDR","type":"string"}]},"minItems":1,"type":"array"},"message":{"maxLength":1024,"default":"Your IP address is not allowed","type":"string","minLength":1},"blacklist":{"items":{"anyOf":[{"format":"ipv4","title":"IPv4","type":"string"},{"pattern":"^([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/([12]?[0-9]|3[0-2])$","title":"IPv4/CIDR","type":"string"},{"format":"ipv6","title":"IPv6","type":"string"},{"pattern":"^([a-fA-F0-9]{0,4}:){1,8}(:[a-fA-F0-9]{0,4}){0,8}([a-fA-F0-9]{0,4})?/[0-9]{1,3}$","title":"IPv6/CIDR","type":"string"}]},"minItems":1,"type":"array"}}},"version":0.1,"priority":3000},"redirect":{"schema":{"$comment":"this is a mark for our injected plugin schema","oneOf":[{"required":["uri"]},{"required":["regex_uri"]},{"required":["http_to_https"]}],"type":"object","properties":{"encode_uri":{"default":false,"type":"boolean"},"uri":{"pattern":"(\\\\\\$[0-9a-zA-Z_]+)|\\$\\{([0-9a-zA-Z_]+)\\}|\\$([0-9a-zA-Z_]+)|(\\$|[^$\\\\]+)","type":"string","minLength":2},"ret_code":{"default":302,"type":"integer","minimum":200},"regex_uri":{"maxItems":2,"minItems":2,"description":"params for generating new uri that substitute from client uri, first param is regular expression, the second one is uri template","items":{"description":"regex uri","type":"string"},"type":"array"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"append_query_string":{"default":false,"type":"boolean"},"http_to_https":{"type":"boolean"}}},"version":0.1,"priority":900},"udp-logger":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["host","port"],"properties":{"max_retry_count":{"minimum":0,"type":"integer","default":0},"include_req_body":{"default":false,"type":"boolean"},"buffer_duration":{"minimum":1,"type":"integer","default":60},"timeout":{"default":3,"type":"integer","minimum":1},"host":{"type":"string"},"batch_max_size":{"minimum":1,"type":"integer","default":1000},"name":{"type":"string","default":"udp logger"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"inactive_timeout":{"minimum":1,"type":"integer","default":5},"port":{"minimum":0,"type":"integer"},"retry_delay":{"minimum":0,"type":"integer","default":1},"log_format":{"type":"object"}}},"metadata_schema":{"properties":{"log_format":{"type":"object"}},"type":"object"},"version":0.1,"priority":400},"hmac-auth":{"consumer_schema":{"type":"object","encrypt_fields":["secret_key"],"title":"work with consumer object","required":["access_key","secret_key"],"properties":{"access_key":{"maxLength":256,"type":"string","minLength":1},"clock_skew":{"default":0,"type":"integer"},"signed_headers":{"items":{"maxLength":50,"type":"string","minLength":1},"type":"array"},"keep_headers":{"default":false,"type":"boolean","title":"whether to keep the http request header"},"encode_uri_params":{"default":true,"type":"boolean","title":"Whether to escape the uri parameter"},"validate_request_body":{"default":false,"type":"boolean","title":"A boolean value telling the plugin to enable body validation"},"max_req_body":{"default":524288,"type":"integer","title":"Max request body size"},"algorithm":{"enum":["hmac-sha1","hmac-sha256","hmac-sha512"],"default":"hmac-sha256","type":"string"},"secret_key":{"maxLength":256,"type":"string","minLength":1}}},"priority":2530,"schema":{"properties":{"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"}},"$comment":"this is a mark for our injected plugin schema","type":"object","title":"work with route or service object"},"version":0.1,"type":"auth"},"traffic-split":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"rules":{"items":{"properties":{"match":{"items":{"properties":{"vars":{"type":"array"}},"type":"object"},"type":"array"},"weighted_upstreams":{"items":{"properties":{"upstream":{"properties":{"desc":{"maxLength":256,"type":"string"},"timeout":{"type":"object","required":["connect","send","read"],"properties":{"connect":{"exclusiveMinimum":0,"type":"number"},"send":{"exclusiveMinimum":0,"type":"number"},"read":{"exclusiveMinimum":0,"type":"number"}}},"update_time":{"type":"integer"},"create_time":{"type":"integer"},"retries":{"minimum":0,"type":"integer"},"retry_timeout":{"minimum":0,"type":"number"},"nodes":{"anyOf":[{"patternProperties":{".*":{"description":"weight of node","minimum":0,"type":"integer"}},"type":"object"},{"items":{"type":"object","required":["host","weight"],"properties":{"metadata":{"description":"metadata of node","type":"object"},"port":{"description":"port of node","minimum":1,"type":"integer"},"priority":{"description":"priority of node","default":0,"type":"integer"},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"weight":{"description":"weight of node","minimum":0,"type":"integer"}}},"type":"array"}]},"labels":{"description":"key/value pairs to specify attributes","patternProperties":{".*":{"maxLength":256,"description":"value of label","pattern":"^\\S+$","minLength":1,"type":"string"}},"type":"object"},"key":{"description":"the key of chash for dynamic load balancing","type":"string"},"hash_on":{"enum":["vars","header","cookie","consumer","vars_combinations"],"type":"string","default":"vars"},"id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"keepalive_pool":{"properties":{"size":{"minimum":1,"type":"integer","default":320},"idle_timeout":{"minimum":0,"type":"number","default":60},"requests":{"minimum":1,"type":"integer","default":1000}},"type":"object"},"scheme":{"enum":["grpc","grpcs","http","https","tcp","tls","udp","kafka"],"description":"The scheme of the upstream. For L7 proxy, it can be one of grpc/grpcs/http/https. For L4 proxy, it can be one of tcp/tls/udp. For specific protocols, it can be kafka.","default":"http"},"name":{"maxLength":100,"minLength":1,"type":"string"},"service_name":{"maxLength":256,"minLength":1,"type":"string"},"pass_host":{"description":"mod of host passing","default":"pass","enum":["pass","node","rewrite"],"type":"string"},"discovery_type":{"description":"discovery type","type":"string"},"upstream_host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"discovery_args":{"properties":{"group_name":{"description":"group name","type":"string"},"namespace_id":{"description":"namespace id","type":"string"}},"type":"object"},"type":{"description":"algorithms of load balancing","default":"roundrobin","type":"string"},"checks":{"anyOf":[{"required":["active"]},{"required":["active","passive"]}],"additionalProperties":false,"type":"object","properties":{"active":{"properties":{"port":{"maximum":65535,"type":"integer","minimum":1},"timeout":{"default":1,"type":"number"},"concurrency":{"default":10,"type":"integer"},"http_path":{"default":"/","type":"string"},"https_verify_certificate":{"default":true,"type":"boolean"},"host":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"unhealthy":{"properties":{"http_failures":{"maximum":254,"default":5,"type":"integer","minimum":1},"tcp_failures":{"maximum":254,"default":2,"type":"integer","minimum":1},"timeouts":{"maximum":254,"default":3,"type":"integer","minimum":1},"http_statuses":{"items":{"maximum":599,"type":"integer","minimum":200},"minItems":1,"default":[429,404,500,501,502,503,504,505],"type":"array","uniqueItems":true},"interval":{"default":1,"type":"integer","minimum":1}},"type":"object"},"req_headers":{"items":{"uniqueItems":true,"type":"string"},"type":"array","minItems":1},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"healthy":{"properties":{"successes":{"maximum":254,"default":2,"type":"integer","minimum":1},"http_statuses":{"items":{"maximum":599,"type":"integer","minimum":200},"minItems":1,"default":[200,302],"type":"array","uniqueItems":true},"interval":{"default":1,"type":"integer","minimum":1}},"type":"object"}},"type":"object"},"passive":{"properties":{"unhealthy":{"properties":{"timeouts":{"maximum":254,"default":7,"type":"integer","minimum":0},"http_failures":{"maximum":254,"default":5,"type":"integer","minimum":0},"http_statuses":{"items":{"maximum":599,"type":"integer","minimum":200},"minItems":1,"default":[429,500,503],"type":"array","uniqueItems":true},"tcp_failures":{"maximum":254,"default":2,"type":"integer","minimum":0}},"type":"object"},"type":{"enum":["http","https","tcp"],"default":"http","type":"string"},"healthy":{"properties":{"http_statuses":{"items":{"maximum":599,"type":"integer","minimum":200},"minItems":1,"default":[200,201,202,203,204,205,206,207,208,226,300,301,302,303,304,305,306,307,308],"type":"array","uniqueItems":true},"successes":{"maximum":254,"default":5,"type":"integer","minimum":0}},"type":"object"}},"type":"object"}}},"tls":{"dependencies":{"client_cert_id":{"not":{"required":["client_cert","client_key"]}},"client_cert":{"required":["client_key"]},"client_key":{"required":["client_cert"]}},"type":"object","properties":{"verify":{"description":"Turn on server certificate verification, currently only kafka upstream is supported","default":false,"type":"boolean"},"client_cert_id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"client_cert":{"maxLength":65536,"type":"string","minLength":128},"client_key":{"maxLength":65536,"type":"string","minLength":128}}}},"additionalProperties":false,"oneOf":[{"required":["nodes"]},{"required":["service_name","discovery_type"]}],"type":"object"},"upstream_id":{"anyOf":[{"maxLength":64,"pattern":"^[a-zA-Z0-9-_.]+$","type":"string","minLength":1},{"minimum":1,"type":"integer"}]},"weight":{"description":"used to split traffic between differentupstreams for plugin configuration","minimum":0,"default":1,"type":"integer"}},"type":"object"},"minItems":1,"maxItems":20,"type":"array","default":[{"weight":1}]}},"type":"object"},"type":"array"}}},"version":0.1,"priority":966},"proxy-rewrite":{"schema":{"$comment":"this is a mark for our injected plugin schema","properties":{"method":{"description":"proxy route method","enum":["HEAD","POST","PUT","DELETE","MKCOL","COPY","MOVE","OPTIONS","PROPFIND","LOCK","UNLOCK","PATCH","TRACE","GET"],"type":"string"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"regex_uri":{"description":"new uri that substitute from client uri for upstream, lower priority than uri property","items":{"description":"regex uri","type":"string"},"minItems":2,"type":"array"},"use_real_request_uri_unsafe":{"description":"use real_request_uri instead, THIS IS VERY UNSAFE.","default":false,"type":"boolean"},"uri":{"maxLength":4096,"description":"new uri for upstream","pattern":"^\\/.*","type":"string","minLength":1},"headers":{"description":"new headers for request","oneOf":[{"properties":{"remove":{"items":{"pattern":"^[^:]+$","type":"string"},"type":"array","minItems":1},"add":{"type":"object","patternProperties":{"^[^:]+$":{"oneOf":[{"type":"string"},{"type":"number"}]}},"minProperties":1},"set":{"type":"object","patternProperties":{"^[^:]+$":{"oneOf":[{"type":"string"},{"type":"number"}]}},"minProperties":1}},"additionalProperties":false,"type":"object","minProperties":1},{"type":"object","patternProperties":{"^[^:]+$":{"oneOf":[{"type":"string"},{"type":"number"}]}},"minProperties":1}]},"host":{"description":"new host for upstream","pattern":"^[0-9a-zA-Z-.]+(:\\d{1,5})?$","type":"string"}},"type":"object","minProperties":1},"version":0.1,"priority":1008},"wolf-rbac":{"priority":2555,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"header_prefix":{"default":"X-","type":"string"},"server":{"default":"http://127.0.0.1:12180","type":"string"},"appid":{"default":"unset","type":"string"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"}}},"version":0.1,"type":"auth"},"http-logger":{"priority":410,"metadata_schema":{"properties":{"log_format":{"type":"object"}},"type":"object"},"version":0.1,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["uri"],"properties":{"max_retry_count":{"minimum":0,"type":"integer","default":0},"include_req_body":{"default":false,"type":"boolean"},"buffer_duration":{"minimum":1,"type":"integer","default":60},"ssl_verify":{"default":false,"type":"boolean"},"batch_max_size":{"minimum":1,"type":"integer","default":1000},"name":{"type":"string","default":"http logger"},"log_format":{"type":"object"},"uri":{"pattern":"^[^\\/]+:\\/\\/([\\da-zA-Z.-]+|\\[[\\da-fA-F:]+\\])(:\\d+)?","type":"string"},"inactive_timeout":{"minimum":1,"type":"integer","default":5},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"include_resp_body_expr":{"items":{"type":"array"},"type":"array","minItems":1},"include_resp_body":{"default":false,"type":"boolean"},"concat_method":{"enum":["json","new_line"],"type":"string","default":"json"},"include_req_body_expr":{"items":{"type":"array"},"type":"array","minItems":1},"auth_header":{"type":"string"},"timeout":{"default":3,"type":"integer","minimum":1},"retry_delay":{"minimum":0,"type":"integer","default":1}}}},"syslog":{"priority":401,"metadata_schema":{"properties":{"log_format":{"type":"object"}},"type":"object"},"version":0.1,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["host","port"],"properties":{"max_retry_count":{"minimum":0,"type":"integer","default":0},"include_req_body":{"default":false,"type":"boolean"},"port":{"type":"integer"},"timeout":{"default":3000,"type":"integer","minimum":1},"batch_max_size":{"minimum":1,"type":"integer","default":1000},"name":{"type":"string","default":"sys logger"},"log_format":{"type":"object"},"inactive_timeout":{"minimum":1,"type":"integer","default":5},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"host":{"type":"string"},"flush_limit":{"default":4096,"type":"integer","minimum":1},"drop_limit":{"default":1048576,"type":"integer"},"sock_type":{"enum":["tcp","udp"],"type":"string","default":"tcp"},"tls":{"default":false,"type":"boolean"},"pool_size":{"default":5,"type":"integer","minimum":5},"retry_delay":{"minimum":0,"type":"integer","default":1},"buffer_duration":{"minimum":1,"type":"integer","default":60}}}},"consumer-restriction":{"schema":{"anyOf":[{"required":["blacklist"]},{"required":["whitelist"]},{"required":["allowed_by_methods"]}],"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"allowed_by_methods":{"items":{"properties":{"methods":{"items":{"description":"HTTP method","enum":["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE","PURGE"],"type":"string"},"type":"array","minItems":1},"user":{"type":"string"}},"type":"object"},"type":"array"},"blacklist":{"items":{"type":"string"},"type":"array","minItems":1},"rejected_msg":{"type":"string"},"whitelist":{"items":{"type":"string"},"type":"array","minItems":1},"rejected_code":{"default":403,"type":"integer","minimum":200},"type":{"enum":["consumer_name","service_id","route_id","consumer_group_id"],"default":"consumer_name","type":"string"}}},"version":0.1,"priority":2400},"fault-injection":{"schema":{"minProperties":1,"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"delay":{"type":"object","required":["duration"],"properties":{"percentage":{"maximum":100,"type":"integer","minimum":0},"duration":{"minimum":0,"type":"number"},"vars":{"maxItems":20,"items":{"type":"array"},"type":"array"}}},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"abort":{"type":"object","required":["http_status"],"properties":{"http_status":{"minimum":200,"type":"integer"},"body":{"minLength":0,"type":"string"},"vars":{"maxItems":20,"items":{"type":"array"},"type":"array"},"headers":{"type":"object","patternProperties":{"^[^:]+$":{"oneOf":[{"type":"string"},{"type":"number"}]}},"minProperties":1},"percentage":{"maximum":100,"type":"integer","minimum":0}}}}},"version":0.1,"priority":11000},"serverless-pre-function":{"priority":10000,"version":0.1,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["functions"],"properties":{"phase":{"enum":["rewrite","access","header_filter","body_filter","log","before_proxy"],"type":"string","default":"access"},"functions":{"items":{"type":"string"},"minItems":1,"type":"array"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"}}}},"jwt-uaa":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"}}},"version":1,"priority":10},"key-auth":{"consumer_schema":{"encrypt_fields":["key"],"type":"object","required":["key"],"properties":{"key":{"type":"string"}}},"priority":2500,"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"query":{"default":"apikey","type":"string"},"hide_credentials":{"default":false,"type":"boolean"},"header":{"default":"apikey","type":"string"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"}}},"version":0.1,"type":"auth"},"api-breaker":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["break_response_code"],"properties":{"max_breaker_sec":{"default":300,"type":"integer","minimum":3},"healthy":{"default":{"http_statuses":[200],"successes":3},"type":"object","properties":{"http_statuses":{"items":{"maximum":499,"type":"integer","minimum":200},"minItems":1,"default":[200],"type":"array","uniqueItems":true},"successes":{"default":3,"type":"integer","minimum":1}}},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"unhealthy":{"default":{"http_statuses":[500],"failures":3},"type":"object","properties":{"http_statuses":{"items":{"maximum":599,"type":"integer","minimum":500},"minItems":1,"default":[500],"type":"array","uniqueItems":true},"failures":{"default":3,"type":"integer","minimum":1}}},"break_response_code":{"maximum":599,"type":"integer","minimum":200},"break_response_body":{"type":"string"},"break_response_headers":{"items":{"type":"object","required":["key","value"],"properties":{"key":{"minLength":1,"type":"string"},"value":{"minLength":1,"type":"string"}}},"type":"array"}}},"version":0.1,"priority":1005},"jwt-sso":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"}}},"version":1,"priority":10},"batch-requests":{"schema":{"$comment":"this is a mark for our injected plugin schema","type":"object","properties":{"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"}}},"metadata_schema":{"properties":{"max_body_size":{"description":"max pipeline body size in bytes","default":1048576,"exclusiveMinimum":0,"type":"integer"}},"type":"object"},"priority":4010,"scope":"global","version":0.1},"limit-conn":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["conn","burst","default_conn_delay","key"],"properties":{"key":{"type":"string"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"rejected_code":{"maximum":599,"default":503,"type":"integer","minimum":200},"rejected_msg":{"minLength":1,"type":"string"},"conn":{"exclusiveMinimum":0,"type":"integer"},"allow_degradation":{"default":false,"type":"boolean"},"burst":{"minimum":0,"type":"integer"},"key_type":{"enum":["var","var_combination"],"default":"var","type":"string"},"default_conn_delay":{"exclusiveMinimum":0,"type":"number"},"only_use_default_delay":{"default":false,"type":"boolean"}}},"version":0.1,"priority":1003},"limit-req":{"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","required":["rate","burst","key"],"properties":{"key":{"type":"string"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"rejected_code":{"maximum":599,"default":503,"type":"integer","minimum":200},"nodelay":{"default":false,"type":"boolean"},"rejected_msg":{"minLength":1,"type":"string"},"rate":{"exclusiveMinimum":0,"type":"number"},"key_type":{"enum":["var","var_combination"],"default":"var","type":"string"},"burst":{"minimum":0,"type":"number"},"allow_degradation":{"default":false,"type":"boolean"}}},"version":0.1,"priority":1001},"echo":{"schema":{"$comment":"this is a mark for our injected plugin schema","anyOf":[{"required":["before_body"]},{"required":["body"]},{"required":["after_body"]}],"properties":{"after_body":{"description":"body after the modification of filter phase.","type":"string"},"body":{"description":"body to replace upstream response.","type":"string"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"before_body":{"description":"body before the filter phase.","type":"string"},"headers":{"description":"new headers for response","minProperties":1,"type":"object"}},"type":"object","minProperties":1},"version":0.1,"priority":412},"referer-restriction":{"schema":{"$comment":"this is a mark for our injected plugin schema","oneOf":[{"required":["whitelist"]},{"required":["blacklist"]}],"type":"object","properties":{"whitelist":{"items":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"minItems":1,"type":"array"},"blacklist":{"items":{"pattern":"^\\*?[0-9a-zA-Z-._\\[\\]:]+$","type":"string"},"minItems":1,"type":"array"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"message":{"maxLength":1024,"default":"Your referer host is not allowed","type":"string","minLength":1},"bypass_missing":{"default":false,"type":"boolean"}}},"version":0.1,"priority":2990},"basic-auth":{"consumer_schema":{"type":"object","encrypt_fields":["password"],"title":"work with consumer object","required":["username","password"],"properties":{"username":{"type":"string"},"password":{"type":"string"}}},"priority":2520,"schema":{"properties":{"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"},"hide_credentials":{"default":false,"type":"boolean"}},"$comment":"this is a mark for our injected plugin schema","type":"object","title":"work with route or service object"},"version":0.1,"type":"auth"},"prometheus":{"priority":500,"version":0.2,"schema":{"type":"object","$comment":"this is a mark for our injected plugin schema","properties":{"prefer_name":{"default":false,"type":"boolean"},"_meta":{"properties":{"error_response":{"oneOf":[{"type":"string"},{"type":"object"}]},"filter":{"description":"filter determines whether the plugin needs to be executed at runtime","type":"array"},"priority":{"description":"priority of plugins by customized order","type":"integer"},"disable":{"type":"boolean"}},"type":"object"}}}}}}
